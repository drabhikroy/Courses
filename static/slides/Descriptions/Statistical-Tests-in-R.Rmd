---
title: "A Very Incomplete Survey of Basic Statistical Tests in R"
author: "EDP 613"
linktitle: "EDP 613"
output: 
 xaringan::moon_reader:
   css: xaringan-themer.css
   nature:
     ratio: 16:9
     highlightStyle: github
     highlightLines: true
     countIncrementalSlides: false
     navigation:
         scroll: false
---

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

<script type="text/x-mathjax-config">
MathJax.Hub.Register.StartupHook("TeX Jax Ready",function () {
  MathJax.Hub.Insert(MathJax.InputJax.TeX.Definitions.macros,{
    cancel: ["Extension","cancel"],
    bcancel: ["Extension","cancel"],
    xcancel: ["Extension","cancel"],
    cancelto: ["Extension","cancel"]
  });
});
</script>

<style>
section {
    display: flex;
    display: -webkit-flex;
}

section p {
    margin: auto;
}

.hljs-github .hljs {
    background: transparent;
    color: #b2dfdb;
}

.hljs-github .hljs-keyword {
    color: #64b5f6;
}

.hljs-github .hljs-literal {
    color: #64b5f6;
}

.hljs-github .hljs-number {
    color: #64b5f6;
}

.hljs-github .hljs-string {
    color: #b7b3ef;
}

section {
    height: 600px;
    width: 60%;
    margin: auto;
    border-radius: 20px;
    background-color: #212121;
}

section p {
    text-align: center;
    font-size: 30px;
    background-color: #212121;
    border-radius: 20px;
    font-family: Roboto Condensed;
    font-style: bold;
    padding: 15px;
    color: #bff4ee;
}

#center {
text-align: center;
}

.center p {
  margin: 0;
  position: absolute;
  top: 50%;
  left: 50%;
  -ms-transform: translate(-50%, -50%);
  transform: translate(-50%, -50%);

</style>

```{r setup, include=FALSE, purl=FALSE}
# knitr::opts_chunk$set(echo = FALSE)

library(tidyverse)
library(infer)
library(patchwork)
library(flipbookr)
library(viridis)
library(knitr)
library(kableExtra)
library(fontawesome)
library(here)
library(DT)
library(scales)
library(latex2exp)
library(xml2)
library(showtext)
font_add_google("Roboto Condensed", "roboto")
showtext_auto()
```

```{r echo = FALSE, purl=FALSE}
xaringanthemer::style_duo(
  primary_color = "#212121",
  secondary_color = "#c4e0f2",
  code_inline_background_color = "transparent",
  code_inline_color = "#b2dfdb",
  code_highlight_color = "#db6464",
  table_row_border_color = "#212121",
  table_row_even_background_color = "#212121",
  footnote_font_size = "0.6em",
  header_font_google = xaringanthemer::google_font("Roboto Condensed", "700"),
  text_font_google   = xaringanthemer::google_font("Roboto Condensed", "400")
)

xaringanExtra::use_xaringan_extra(c("tile_view", "animate_css", "tachyons"))

xaringanExtra::use_logo(
  image_url = here::here("static", "img", "course_hex_alpha.png"),
  link_url = "https://edp613.asocialdatascientist.com",
  position = xaringanExtra::css_position(top = "1em", right = "1em")
)
```

# Packages needed and a Note about Icons

Please load up the following packages (or install and then load them as needed)
```{r}
library(tidyverse)
library(car)
library(foreign)
library(lme4)
library(MASS)
library(CCA)
library(psych)
```
<br>
You may come across the following icons. The table below lists what each means.
```{r eval = TRUE, echo = FALSE, purl=FALSE}
forward <- fontawesome::fa("forward", fill = "#4682b4")

stop <- fontawesome::fa("stop", fill = "#ff6347")

link <- fontawesome::fa("link", fill = "#5cb85c")

bookmark <- fontawesome::fa("bookmark", fill = "#faffbd")


icon_desc <- tibble(
  
  Icon = c(forward,
           stop, 
           link,
           bookmark),
  
  Description = c("Indicates that an example continues on the following slide.",
                  "Indicates that a section using common syntax has ended.",
                  "Indicates that there is an active hyperlink on the slide.",
                  "Indicates that a section covering a concept has ended.")
  
)
```

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, purl=FALSE}
kable(icon_desc, 
      escape = FALSE,
      align = 'cl') %>%
  kable_styling(full_width = FALSE) %>%
  column_spec(1, width = "10em") %>%
  column_spec(2, width = "40em") 
```

---

# A Side Note About R

Its a big deal that you have come this far with `R` especially since it was rough at times. It may not be apparent, but developing coding skills like the ones in this course have benefits, not least of all in simply understanding the structure of a given data set. There are too many examples of students and even professionals who run an analysis on data without considering the data itself. `R` and other syntax-based software packages like it to their credit make you explore your data whether it be through checks or frustration.

While proprietary softwares such as SPSS, SAS, Minitab, etc. may be easier to learn, `R` and others like Python are free, open, and widley used. Picking on SPSS, as of this writing users pay for different tiers depending on needs (such as machine learning, methods to deal with missing data, etc.) they want to use. s

With that said, learning `R` is a lifelong process and assisting student learning and growth should never be confined to a single course so please FEEL FREE to contact me if you have questions regarding R (or Python if you go there) at any time. Again, I will always make time for students.

---

# Purpose

This walk-through will provide you with information on how to perform a number of statistical tests using R. Some of these will look familiar while others you will be exposed to in future statistics courses if that is your path. In either case, hopefully these will be helpful if for no other reason than to provide a check or confirmation of results.

---

# Decisions Decisions Decisions

When deciding which test is appropriate to use, it is important to consider the type of variables that you have. Please load in the following data sets (and look at them by using `View()` or `head()`

```{r eval=FALSE}
some_ed_data <- 
  read_csv("some_ed_data.csv")
```

```{r echo=FALSE, message = FALSE, purl=FALSE}
some_ed_data <- 
  read_csv(here::here("static", "data", "R", "some_ed_data.csv"))
```

```{r eval=FALSE}
some_exercise_data <- 
  read_csv("some_exercise_data.csv")
```

```{r echo=FALSE, message = FALSE, purl=FALSE}
some_exercise_data <- 
  read_csv(here::here("static", "data", "R", "some_exercise_data.csv"))
```

```{r eval=FALSE}
some_survey_data <- 
  read_csv("some_survey_data.csv")
```

```{r echo=FALSE, message = FALSE, purl=FALSE}
some_survey_data <- 
  read_csv(here::here("static", "data", "R", "some_survey_data.csv"))
```

---

# Source 

A majority of the information included in this survey of approached was scraped from the web using `R` via the [UCLA Institute for Digital Research & Education](https://stats.idre.ucla.edu/r/whatstat/what-statistical-analysis-should-i-usestatistical-analyses-using-r/) site using the `xml2` package. They also fully support SAS, SPSS (for those of you moving on to EDP 614), Stata, and Mplus. 

---

# An Incomplete Table of Approaches (1/4)

```{r get_table, echo=FALSE, include=FALSE, purl=FALSE}
webpage_url <- 
  "https://stats.idre.ucla.edu/other/mult-pkg/whatstat/"

webpage <- 
  xml2::read_html(webpage_url)

WebTable<- 
  rvest::html_table(webpage)[[1]] %>% 
  tibble::as_tibble(.name_repair = "unique") 

StatsTable <- 
  WebTable %>%
  rename(`Type of Dependent Variables` = `Nature of Dependent Variable(s)*`) %>%
  rename(`Number and Type of Independent Variables`= `Nature of Independent Variables`) %>%
  dplyr::select(-starts_with("How to")) %>%
  # add_column(Link = "") %>%
  filter(`Test(s)` != "")
```

```{r, echo = FALSE, eval = TRUE}
kable(StatsTable %>% 
        slice(1:8), 
      escape = FALSE, 
      align = c("clll")) %>%
  kable_styling(full_width = FALSE) 
```

---

# An Incomplete Table of Approaches (2/4)

```{r, echo = FALSE, eval = TRUE}
kable(StatsTable %>% 
        slice(9:17), 
      escape = FALSE, 
      align = c("clll")) %>%
  kable_styling(full_width = FALSE) 
```

---

# An Incomplete Table of Approaches (3/4)

```{r, echo = FALSE, eval = TRUE}
kable(StatsTable %>% 
        slice(18:24), 
      escape = FALSE, 
      align = c("clll")) %>%
  kable_styling(full_width = FALSE) 
```

---

# An Incomplete Table of Approaches (4/4)

```{r, echo = FALSE, eval = TRUE}
kable(StatsTable %>% 
        slice(25:32), 
      escape = FALSE, 
      align = c("clll")) %>%
  kable_styling(full_width = FALSE) 
```

---

# Tests

---

## ANCOVA (Analysis of Covariance)
```{r}
summary(aov(some_ed_data$write ~ 
              some_ed_data$prog + 
              some_ed_data$read))
```

---

## Binomial Test
```{r}
prop.test(sum(some_ed_data$female), 
          length(some_ed_data$female), 
          p = 0.5)
```

---

## Canonical Correlation
```{r}
cc(cbind(some_ed_data$read, 
         some_ed_data$write), 
   cbind(some_ed_data$math, 
         some_ed_data$science))
```

---

## Chi-square Test
```{r}
chisq.test(table(some_ed_data$female, 
                 some_ed_data$schtyp))
```

---

## Chi-square Goodness of Fit
```{r}
chisq.test(table(some_ed_data$race), 
           p = c(10, 10, 10, 70)/100)
```

---

## Correlation
```{r}
cor(some_ed_data$read, 
    some_ed_data$write)

cor.test(some_ed_data$read, 
         some_ed_data$write)
```

---

## Discriminant Analysis
```{r}
lda(factor(some_ed_data$prog) ~ 
      some_ed_data$read + 
      some_ed_data$write + 
      some_ed_data$math, 
    data = some_ed_data)
```

---

## Factor Analysis
```{r}
fa(r = cor(model.matrix(~read + write + math + science + socst - 1, 
                        data = some_ed_data)), 
   rotate = "none",
   fm = "pa", 2)
```

---

## Factorial ANOVA (Analysis of Variance)
```{r}
anova(lm(write ~ female * ses, 
         data = some_ed_data))
```

---

## Factorial Logistic Regression
```{r}
summary(glm(female ~ prog * schtyp, 
            data = some_ed_data, 
            family = binomial))
```

---

## Friedman Test
```{r}
friedman.test(cbind(some_ed_data$read, 
                    some_ed_data$write, 
                    some_ed_data$math))
```

---

## Kruskal Wallis Test
```{r}
kruskal.test(some_ed_data$write, 
             some_ed_data$prog)
```

---

## McNemar Test
```{r}
# Some made up data in matrix form
made_up_matrixdata <- 
  matrix(c(150, 22, 21, 12), 2, 2)

mcnemar.test(made_up_matrixdata)
```

---

## Multiple Regression
```{r}
lm(some_ed_data$write ~ 
     some_ed_data$female + 
     some_ed_data$read + 
     some_ed_data$math + 
     some_ed_data$science + 
     some_ed_data$socst)
```

---

## Multivariate Multiple Regression
```{r}
mmrlm <- 
  lm(cbind(write, read) ~ 
       female + math + science + socst, 
     data = some_ed_data)

summary(Anova(mmrlm))
```

---

## Non-parametric Correlation
```{r}
cor.test(some_ed_data$read, 
         some_ed_data$write, 
         method = "spearman")
```

---

## One Sample *t*-test
```{r}
t.test(some_ed_data$read, 
       mu = 50)
```

---

## One-way Analysis of Variance (ANOVA)
```{r}
summary(aov(some_ed_data$read ~ 
              some_ed_data$prog))
```

---

## One-way Multivariate Analysis of Variance (MANOVA)
```{r}
summary(manova(cbind(some_ed_data$read, 
                     some_ed_data$write, 
                     some_ed_data$math) ~ 
                 some_ed_data$prog))
```

---

## One-way Repeated Measures Analysis of Variance (ANOVA)
```{r}
model <- 
  lm(gender ~ item_1 + item_2, 
     data = some_survey_data)

analysis <- 
  Anova(model, 
        idata = factor_surveydata, 
        idesign = ~s) 

print(analysis)
```

---

## Ordered Logistic Regression
```{r}
# Create ordered variable write3 as 
# a factor with levels 1, 2, and 3
some_ed_data$write3 <- 
  cut(some_ed_data$write, 
      c(0, 48, 57, 70),  
      right = TRUE, 
      labels = c(1,2,3))

table(some_ed_data$write3)

# fit ordered logit model and store results 'some_write_data'
some_write_data <- 
  polr(write3 ~ 
         female + read + socst, data = some_ed_data, 
       Hess=TRUE)

summary(some_write_data)
```

---

## Principal Components Analysis (PCA)
```{r}
princomp(formula = ~read + write + math + science + socst, 
         data = some_ed_data)
```

---

## Repeated Measures Logistic Regression
```{r}
glmer(highpulse ~ diet + (1 | id), 
      data = some_exercise_data, 
      family = binomial)
```

---

## Simple Linear Regression
```{r}
lm(some_ed_data$write ~ 
     some_ed_data$read)
```

---

## Simple Logistic Regression
```{r}
glm(some_ed_data$female ~ 
      some_ed_data$read, 
    family = binomial)
```

---

## Two Independent Samples *t*-test
```{r}
t.test(some_ed_data$read ~ 
         some_ed_data$female)
```

---

## Wilcoxon-Mann-Whitney Test
```{r}
wilcox.test(some_ed_data$read ~ 
              some_ed_data$female)
```

---

## Wilcoxon Signed Rank Sum Test
```{r}
wilcox.test(some_ed_data$write, 
            some_ed_data$read, 
            paired = TRUE)
```

---

# Other Approaches
There are so many other approaches that are for specific cases or use statistical approaches, but aren't [themselves statistics](https://www.nature.com/articles/nmeth.4642). With that said, the ones given in this overview are overkill for most of you and should cover any statistics you come across. 

---

# Additional Things

---

## Reporting 
After running a statistical test successfully, it can be difficult to know how to report the results. The `report` package automatically produces reports of models and dataframes according to best practices guidelines. Click [here](https://easystats.github.io/report/) for more information.

---

## Visualizations
Interested in making incredible visuals? Check out [#tidytuesday](https://twitter.com/hashtag/tidytuesday) on Twitter. You do not need an account for access.

---

## Something useless
If you are a fan of the show Rick & Morty, consider downloading the most pointless package `mortyr` to do pointless statistics on pointless data. More about the package [here](https://github.com/mikejohnpage/mortyr). 

---

## Thats it!

