---
title: "A Very Incomplete Survey of Basic Statistical Tests in R"
subtitle: "EDP 619 Week 5"
author: "Dr. Abhik Roy"
output: 
 xaringan::moon_reader:
   css: ['xaringan-themer.css', 'custom.css']
   nature:
     ratio: 16:9
     highlightStyle: github
     highlightLines: true
     countIncrementalSlides: false
     navigation:
         scroll: false
---

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

<script type="text/x-mathjax-config">
MathJax.Hub.Register.StartupHook("TeX Jax Ready",function () {
  MathJax.Hub.Insert(MathJax.InputJax.TeX.Definitions.macros,{
    cancel: ["Extension","cancel"],
    bcancel: ["Extension","cancel"],
    xcancel: ["Extension","cancel"],
    cancelto: ["Extension","cancel"]
  });
});
</script>

<style>
section {
    display: flex;
    display: -webkit-flex;
}

section {
    height: 600px;
    width: 60%;
    margin: auto;
    border-radius: 21px;
    background-color: #212121;
}

.remark-slide-container {
background: #212121;
}

.hljs-github .hljs {
    background: transparent;
    color: #b2dfdb;
}

.hljs-github .hljs-keyword {
    color: #64b5f6;
}

.hljs-github .hljs-literal {
    color: #64b5f6;
}

.hljs-github .hljs-number {
    color: #64b5f6;
}

.hljs-github .hljs-string {
    color: #b7b3ef;
}


.hljs-github .hljs {
    background: transparent;
    color: #b2dfdb;
}

.hljs-github .hljs-keyword {
    color: #64b5f6;
}

.hljs-github .hljs-literal {
    color: #64b5f6;
}

.hljs-github .hljs-number {
    color: #64b5f6;
}

.hljs-github .hljs-string {
    color: #b7b3ef;
}

section p {
    text-align: center;
    font-size: 30px;
    background-color: #212121;
    border-radius: 21px;
    font-family: Roboto Condensed;
    font-style: bold;
    padding: 12px;
    color: #bff4ee;
    margin: auto;
}

#center {
text-align: center;
}

#right {
  text-align: right;
} 

.center p {
  margin: 0;
  position: absolute;
  top: 50%;
  left: 50%;
  -ms-transform: translate(-50%, -50%);
  transform: translate(-50%, -50%);
}

.center2 {
  margin: 0;
  position: absolute;
  top: 50%;
  left: 50%;
  -ms-transform: translate(-50%, -50%);
  transform: translate(-50%, -50%);
}

.tab {
    display: inline-block;
    margin-left: 40px;
}

.obr
{
    display:block;
    margin-top:-15px;
}
</style>

```{css echo=FALSE}
.highlight-last-item > ul > li,
.highlight-last-item > ol > li {
  opacity: 0.5;
}
.highlight-last-item > ul > li:last-of-type,
.highlight-last-item > ol > li:last-of-type {
  opacity: 1;
}
```

```{r setup, include=FALSE, purl=FALSE}
# knitr::opts_chunk$set(echo = FALSE)

library(tidyverse)
library(infer)
library(patchwork)
library(flipbookr)
library(viridis)
library(knitr)
library(kableExtra)
library(fontawesome)
library(here)
library(DT)
library(scales)
library(latex2exp)
library(xml2)
library(showtext)
font_add_google("Roboto Condensed", "roboto")
showtext_auto()
```

```{r echo = FALSE, purl=FALSE}
xaringanthemer::style_duo(
  primary_color = "#212121",
  secondary_color = "#bff4ee",
  link_color = "#b1ead6",
  text_bold_color = "#4dc6e2",
  table_row_border_color = "#212121",
  table_row_even_background_color = "#212121",
  footnote_font_size = "0.6em",
  header_font_google = xaringanthemer::google_font("Roboto Condensed", "700"),
  text_font_google   = xaringanthemer::google_font("Roboto Condensed", "400")
)

xaringanExtra::use_xaringan_extra(c("tile_view", 
                                    "animate_css", 
                                    "tachyons"))

xaringanExtra::use_logo(
  image_url = here::here("static", "img", "course_hex.png"),
  link_url = "https://edp619.asocialdatascientist.com",
  position = xaringanExtra::css_position(top = "1em", right = "1em")
)
```

---

class: highlight-last-item
layout: true

---

# Getting Ready

To follow along, please make sure to do the following

--

1. Run `Basic Statistical Tests install.R`

--

2. Open up a blank `.R` script

--

3. Load up the following packages 
    ```{r, messages = FALSE, eval = FALSE}
    library(tidyverse)
    library(car)
    library(foreign)
    library(lme4)
    library(MASS)
    library(CCA)
    library(psych)
    ```
    
    ```{r, messages = FALSE, echo = FALSE}
    suppressPackageStartupMessages(library(tidyverse))
    suppressPackageStartupMessages(library(car))
    suppressPackageStartupMessages(library(foreign))
    suppressPackageStartupMessages(library(lme4))
    suppressPackageStartupMessages(library(MASS))
    suppressPackageStartupMessages(library(CCA))
    suppressPackageStartupMessages(library(psych))
    ```

---

# Purpose

This is not a traditional presentation per say, rather it is a collection of common statistical tests used for survey analyses that you may need to use at some point. Review the content simply to see what is included and then come back as needed.

> The examples are of course presented with R in mind, but obviously not restricted to the platform. 

--

> The content is intended to cast a wide net so some may look familiar while others will not

--

> You can think of this as a toolkit

---

# Note

Here are some things to consider as you go through this


+ Items in here will apply depending on your focus and strengths

--

+ Never memorize formulas - that's what the Internet is for. Rather it is important to know what test applies to which scenario

--

+ Since this is not a statistics course, only test names and examples are provided

--

+ Some of the syntax may be structured in an odd way. This is only done so so that they be fit within the slide. Remember in general spacing doesn't mean much in R

--

+ These are presented in alphabetical order according to the standard name of the test

---

# Decisions Decisions Decisions

When deciding which test is appropriate to use, it is important to consider the type of variables that you have. Please load in the following data sets (and look at them by using `View()` or `head()`

```{r eval=FALSE}
some_ed_data <- 
  read_csv("some_ed_data.csv")
```

```{r echo=FALSE, message = FALSE, purl=FALSE}
some_ed_data <- 
  read_csv(here::here("static", "data", "R", "some_ed_data.csv"))
```

```{r eval=FALSE}
some_exercise_data <- 
  read_csv("some_exercise_data.csv")
```

```{r echo=FALSE, message = FALSE, purl=FALSE}
some_exercise_data <- 
  read_csv(here::here("static", "data", "R", "some_exercise_data.csv"))
```

```{r eval=FALSE}
some_survey_data <- 
  read_csv("some_survey_data.csv")
```

```{r echo=FALSE, message = FALSE, purl=FALSE}
some_survey_data <- 
  read_csv(here::here("static", "data", "R", "some_survey_data.csv"))
```

---

# The Datas (1/3)

```{r}
some_ed_data
```

---

# The Datas (2/3)

```{r}
some_exercise_data
```

---

# The Datas (3/3)

.pull-left[
```{r survey, eval=FALSE}
some_survey_data
```
]

.pull-right[
```{r survey-out, ref.label="survey", echo=FALSE}
```
]


---

# An Incomplete Table of Approaches 

```{r get_table, echo=FALSE, include=FALSE, purl=FALSE}
webpage_url <- 
  "https://stats.idre.ucla.edu/other/mult-pkg/whatstat/"

webpage <- 
  xml2::read_html(webpage_url)

WebTable <- 
  rvest::html_table(webpage)[[1]] %>% 
  tibble::as_tibble(.name_repair = "unique") 

StatsTable <- 
  WebTable %>%
  rename(`Type of Dependent Variables` = `Nature of Dependent Variable(s)*`) %>%
  rename(`Number and Type of Independent Variables`= `Nature of Independent Variables`) %>%
  dplyr::select(-starts_with("How to")) %>%
  # add_column(Link = "") %>%
  filter(`Test(s)` != "")
```

```{r, echo = FALSE, eval = TRUE}
DT::datatable(StatsTable,
              rownames = FALSE,
              class = list(stripe = FALSE),
              extensions = 'Buttons',
              options = list(
                pageLength = 7,
                searching = FALSE,
                autoWidth = FALSE,
                dom = "Brtip",
                buttons = c('copy', 'csv', 'excel', 'pdf'),
                lengthMenu = FALSE,
                columnDefs = list(list(className = 'dt-center', targets = 0)),
                buttons = list(
                              list(extend = 'colvis',
                                   text = 'Toggle Column Visibility',
                                   columns = c(0:14),
                                   className = "btn btn-outline-primary mr-1",
                                   collectionLayout = 'two-column'
                              ),
                              list(extend = 'collection',
                                   buttons = list(list(extend = "copy", exportOptions = list(columns = ":visible")),
                                                  list(extend = "csv", exportOptions = list(columns = ":visible")),
                                                  list(extend = "excel", exportOptions = list(columns = ":visible")),
                                                  list(extend = "pdf", exportOptions = list(columns = ":visible"))),
                                   text = 'Special Export',
                                   className = "btn btn-outline-primary mr-1"
                                   )
                              ),
                initComplete = JS(
                  "function(settings, json) {",
                  "$(this.api().table().header()).css({'color': '#fff'});",
                  "}")
                ),
              callback=JS('$("button.buttons-copy").css("color","#bb86fc"); 
                           $("button.buttons-csv").css("color","#bb86fc"); 
                           $("button.buttons-excel").css("color","#bb86fc"); 
                           $("button.buttons-pdf").css("color","#bb86fc"); 
                            return table;')
              ) %>%
  formatStyle(colnames(StatsTable), color = 'white', backgroundColor = '#212121')
```

---


# Tests

---

## ANOVA

```{r}
summary(aov(some_ed_data$write ~ some_ed_data$prog + some_ed_data$read))
```

---

## Binomial Test
```{r}
prop.test(sum(some_ed_data$female), length(some_ed_data$female), p = 0.5)
```

---

## Canonical Correlation

.pull-left[
```{r cc, eval=FALSE}
cc(cbind(some_ed_data$read, some_ed_data$write), 
   cbind(some_ed_data$math, some_ed_data$science))
```
]

.pull-right[
```{r cc-out, ref.label="cc", echo=FALSE}
```
]


---

## Chi-square Test

```{r chi}
chisq.test(table(some_ed_data$female, some_ed_data$schtyp))
```

---

## Chi-square Goodness of Fit
```{r}
chisq.test(table(some_ed_data$race), p = c(10, 10, 10, 70)/100)
```

---

## Correlation
```{r}
cor(some_ed_data$read, some_ed_data$write)

cor.test(some_ed_data$read, some_ed_data$write)
```

---

## Discriminant Analysis

```{r disc}
lda(factor(some_ed_data$prog) ~ some_ed_data$read + some_ed_data$write + some_ed_data$math, data = some_ed_data)
```

---

## Factor Analysis
```{r}
fa(r = cor(model.matrix(~read + write + math + science + socst - 1, data = some_ed_data)), rotate = "none", fm = "pa", 2)
```

---

## Factorial ANOVA (Analysis of Variance)
```{r}
anova(lm(write ~ female * ses, data = some_ed_data))
```

---

## Factorial Logistic Regression
```{r}
summary(glm(female ~ prog * schtyp, data = some_ed_data, family = binomial))
```

---

## Friedman Test
```{r}
friedman.test(cbind(some_ed_data$read, some_ed_data$write, some_ed_data$math))
```

---

## Kruskal Wallis Test
```{r}
kruskal.test(some_ed_data$write, some_ed_data$prog)
```

---

## McNemar Test
```{r}
# Some made up data in matrix form
made_up_matrixdata <- matrix(c(150, 22, 21, 12), 2, 2)

mcnemar.test(made_up_matrixdata)
```

---

## Multiple Regression
```{r}
lm(some_ed_data$write ~ 
     some_ed_data$female + some_ed_data$read + some_ed_data$math + some_ed_data$science + some_ed_data$socst)
```

---

## Multivariate Multiple Regression
```{r}
mmrlm <- lm(cbind(write, read) ~ female + math + science + socst, data = some_ed_data)

summary(Anova(mmrlm))
```

---

## Non-parametric Correlation
```{r}
cor.test(some_ed_data$read, some_ed_data$write, method = "spearman")
```

---

## One Sample *t*-test
```{r}
t.test(some_ed_data$read, mu = 50)
```

---

## One-way Analysis of Variance (ANOVA)
```{r}
summary(aov(some_ed_data$read ~ some_ed_data$prog))
```

---

## One-way Multivariate Analysis of Variance (MANOVA)
```{r}
summary(
  manova(
    cbind(some_ed_data$read, some_ed_data$write, some_ed_data$math) ~ some_ed_data$prog
    )
  )
```

---

## One-way Repeated Measures Analysis of Variance (ANOVA)
```{r}
model <-  lm(gender ~ item_1 + item_2, data = some_survey_data)

analysis <- Anova(model, idata = factor_surveydata, idesign = ~s) 

print(analysis)
```

---

## Ordered Logistic Regression

.pull-left[
```{r orderedvar, eval=FALSE}
# Create ordered variable write3 as 
# a factor with levels 1, 2, and 3
some_ed_data$write3 <- 
  cut(some_ed_data$write, c(0, 48, 57, 70), 
      right = TRUE, 
      labels = c(1,2,3))

table(some_ed_data$write3)
```
]

.pull-right[
```{r orderedvar-out, ref.label="orderedvar", echo=FALSE}
```
]

.pull-left[
```{r orderedlogit, eval=FALSE}
# fit ordered logit model and store results 'some_write_data'
some_write_data <- 
  polr(write3 ~ 
         female + read + socst, data = some_ed_data, 
       Hess=TRUE)

summary(some_write_data)
```
]

.pull-right[
```{r orderedlogit-out, ref.label="orderedlogit", echo=FALSE}
```
]

---

## Principal Components Analysis (PCA)
```{r}
princomp(formula = ~read + write + math + science + socst, data = some_ed_data)
```

---

## Repeated Measures Logistic Regression
```{r}
glmer(highpulse ~ diet + (1 | id), data = some_exercise_data, family = binomial)
```

---

## Simple Linear Regression
```{r}
lm(some_ed_data$write ~ some_ed_data$read)
```

---

## Simple Logistic Regression
```{r}
glm(some_ed_data$female ~ some_ed_data$read, family = binomial)
```

---

## Two Independent Samples *t*-test
```{r}
t.test(some_ed_data$read ~ some_ed_data$female)
```

---

## Wilcoxon-Mann-Whitney Test
```{r}
wilcox.test(some_ed_data$read ~ some_ed_data$female)
```

---

## Wilcoxon Signed Rank Sum Test
```{r}
wilcox.test(some_ed_data$write, some_ed_data$read, paired = TRUE)
```

---

# Other Approaches
There are so many other approaches that are for specific cases or use statistical approaches, but aren't [themselves statistics](https://www.nature.com/articles/nmeth.4642). With that said, the approaches given in this overview cover the gambit of what you will likely need 
---

# Some Extra Things

---

## Reporting 
After running a statistical test successfully, it can be difficult to know how to report the results. The `report` package automatically produces reports of models and dataframes according to best practices guidelines. Click [here](https://easystats.github.io/report/) for more information.

---

## Visualizations
Interested in making incredible visuals? Check out [#tidytuesday](https://twitter.com/hashtag/tidytuesday) on Twitter. You do not need an account for access.

---

## Something useless
If you are a fan of the show Rick & Morty, consider downloading the most pointless package `mortyr` to do pointless statistics on pointless data. More about the package [here](https://github.com/mikejohnpage/mortyr). 

---

## Source 

A majority of the information included in this survey of approached was scraped from the web using `R` via the [UCLA Institute for Digital Research & Education](https://stats.idre.ucla.edu/r/whatstat/what-statistical-analysis-should-i-usestatistical-analyses-using-r/) site using the `xml2` package. They also fully support SAS, SPSS (for some reason), Stata, and Mplus. 

---

## Thats it!

If you have any questions, please reach out

--

<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<center>
<br><br>
<div class="fade_rule"></div>  
<br><br>
</center>

<center>
<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" /></a><br /><br />This work is licensed under a <br /><a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>
</center>
