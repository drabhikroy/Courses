---
title: "Estimations"
subtitle: "EDP 613"
author: "Week 8"
output: 
 xaringan::moon_reader:
   css: xaringan-themer.css
   nature:
     ratio: 16:9
     highlightStyle: github
     highlightLines: true
     countIncrementalSlides: false
     navigation:
         scroll: false
---

<style>

.center2 {
  margin: 0;
  position: absolute;
  top: 50%;
  left: 50%;
  -ms-transform: translate(-50%, -50%);
  transform: translate(-50%, -50%);
}

</style>

```{r setup, include=FALSE, purl=FALSE}
library(tidyverse)
library(knitr)
library(kableExtra)
library(fontawesome)
library(here)
library(DT)
library(scales)
library(latex2exp)
library(showtext)
font_add_google("Roboto Condensed", "roboto")
showtext_auto()
```
```{r echo = FALSE, purl=FALSE}
xaringanthemer::style_duo(
  primary_color = "#212121",
  secondary_color = "#f4eebf",
  table_row_border_color = "#212121",
  table_row_even_background_color = "#212121",
  footnote_font_size = "0.6em",
  header_font_google = xaringanthemer::google_font("Roboto Condensed", "700"),
  text_font_google   = xaringanthemer::google_font("Roboto Condensed", "400")
)
xaringanExtra::use_xaringan_extra(c("tile_view", "animate_css", "tachyons"))

xaringanExtra::use_logo(
  image_url = here::here("static", "img", "course_hex_alpha.png"),
  link_url = "https://edp613.asocialdatascientist.com",
  position = xaringanExtra::css_position(bottom = "1em", left = "1em")
)
```

# <span style='color:#bff4ee;'>A Note About The Slides</span>

Currently the equations may not show up properly in Firefox. Other browsers such as Chrome and Safari do appear to render them correctly. 

---

# <span style='color:#bff4ee;'>A Note About Probability</span>

We're going to introduce some concepts from Chapter 8 here.

---

# <span style='color:#bff4ee;'>From</span> To

--

<br>
<center>
<b style="color:#bff4ee;">Descriptive Statistics</b><br><br><i style="color:#bff4ee;">mathematical techniques for organizing and summarizing a set of numerical data</i>
</center>
<br>

--

<br style="line-height: 3px" />
<center>
`r fa("arrow-down", fill = "#bff4ee")`
</center>
<br style="line-height: 3px" />
<center>
`r fa("arrow-down", fill = "#daf1d7")`
</center>
<br style="line-height: 3px" />
<center>
`r fa("arrow-down", fill = "#f4eebf")`
</center>
<br style="line-height: 3px" />

--

<br>
<center>
<b style="color:#f4eebf;">Inferential Statistics</b><br><br><i style="color:#f4eebf;">generalizing from a sample to a population</i>
</center>

---

# Terms

- **Statistic** - Mathematical expression that describes some aspects of a set of scores for a sample

--

- **Parameter** - Describes some aspect of a set of scores for a population

---

# First a Brief Intro to Hypothesis Testing 

--

>- Formally - Testing an assumption about a population parameter

--

>- In Better Terms - An assumption about a particular situation of the world that is testable


---

# The Null Hypothesis


>- Represented as $H_0$

--

>- is basically what you expect to happen before you run an experiment

--

>- *You have to know what the Null is!*

---

# The Alternative Hypothesis

>- Represented as $H_1$ (or $H_A$)

--

>- is basically what else could happen if what you expect doesn't occur

--

>- *You don't have to know this!*

---

# Tests of Statistical Significance


>- *Formally* - Done to determine whether $H_0$ or $H_1$ can be rejected

--

>- *Better Explanation* - Test to figure out whether you can reasonably say if your initial assumption won't happen

--

>- *Results* - If the outcomes of a study don't go against what you expected to happen, then you aren't finding anything new or surprising

---

# Term

A **(statistical) estimation ** is a sample statistic is used to estimate the value of an unknown population parameter.

---

# Idea of Positive and Negative Outcomes

- The Null hypothesis $H_0$ is typically assuming nothing is going to happen

  - If $H_0$ turns out to be right, then its called a ***negative*** outcome because nothing changed.

--

  - If $H_1$ turns out to be right, then its called a ***positive*** outcome because something that you expected to happen didn't happen.

--

>- Experiment: Over the span of one year, a group of people with ADHD gets an experimental pill that may help them focus better than their current medication

--

>>- $H_0$: Group stays the same (expected)

>>- $H_A$: Group is more focused (what we want to happen)

--

>- Results: After an assessment

>>- if the Group doesn't show greater focus, then we have a ***negative*** outcome because that's what was expected to happen

>>- if the Group shows greater focus, then we have a ***positive*** outcome because that's NOT what was expected to happen

---

# Notes about $H_0$ and $H_A$
<center>
$H_A$ is typically not the only alternative explanation
</center>
</br>

--

- What if the Group was found to more focused?

>- As a rule of thumb don't say that $H_A$ is correct unless you absolutely know there are two outcomes (aka *binary outcomes*)

>- Instead write that "we reject $H_0$" because you don't know if that's the ONLY alternative hypothesis. 
>>- It could also be that in other experiments that groups are found to be less focused!

--

<br>
- What if nothing happened to the Group?

>- You can absolutely say that $H_0$ is correct because that's what you expected

>- So you can write that "we accept $H_0$"

---

# Formal Table of Statistical Error Types

--

.center2[
```{r eval = TRUE, echo = FALSE}
errors <- tibble(
Decision = c("Reject Null",
             "Fail to Reject Null"),

`Null is True` = c("<b style='color:#f4bfc5;'>Type I Error</b><br>(aka <b><i style='color:#f4bfc5;'>False Positive</i></b>)",
                   "<span style='color:#bfe0f4;'>Correct Outcome</span><br>(aka <i style='color:#bfe0f4;'>True Negative</i>)"),

`Null is False` = c("<span style='color:#bfe0f4;'>Correct Outcome</span><br>(aka <i style='color:#bfe0f4;'>True Positive</i>)",
                    "<b style='color:#f4bfc5;'>Type II Error</b><br>(aka <b><i style='color:#f4bfc5;'>False Negative</i></b>)")
)
```

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE}
kable(errors, 
      escape = FALSE,
      align = 'lll') %>%
  kable_styling(full_width = FALSE) %>%
  column_spec(1, width = "10em") %>%
  column_spec(2, width = "10em") %>%
  column_spec(3, width = "10em") %>%
  row_spec(0, background = "#212121") %>%
  row_spec(2, background = "#212121")
```
]

---

# Nutshell Table of Statistical Error Types

--

```{r eval = TRUE, echo = FALSE}
errors <- tibble(
Decision = c(
  "",
  "",
  "You changed your mind",
  "",
  "<center>Results in a</center>",
  "",
  "",
  "You didn't change your mind",
  "",
  "<center>Results in a</center>"),

`Your first thought was right` = c(
  "",
  "",
  "<b style='color:#f4bfc5;'>You changed your mind<br>BUT<br>the reality is you shouldn't have</b>", 
  "",
  "<center><b><i style='color:#f4bfc5;'>False Positive / Type I Error</i></b></center>",
  "",
  "",
  "<span style='color:#bfe0f4;'>You didn't change your mind<br>AND<br>in reality that was the right decision</span>", 
  "",
  "<center><i style='color:#bfe0f4;'>True Negative</i></center>"),

`Your first thought was wrong` = c(
  "",
  "",
  "<span style='color:#bfe0f4;'>You changed your mind<br>AND<br>in reality that was the right decision</span>",
  "",
  "<center><i style='color:#bfe0f4;'>True Positive</i></center>",
  "",
  "",
  "<b style='color:#f4bfc5;'>You didn't change your mind<br>BUT<br>the reality is that you should have</b>",
  "",
  "<center><b><i style='color:#f4bfc5;'>False Negative / Type II Error</i></b></center>")
)
```

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE}
kable(errors, 
      escape = FALSE,
      align = 'ccc') %>%
  kable_styling(full_width = FALSE) %>%
  column_spec(1, width = "20em") %>%
  column_spec(2, width = "30em") %>%
  column_spec(3, width = "30em") %>%
  row_spec(0, background = "#212121") %>%
  row_spec(2, background = "#212121")
```

---

## Example

```{r eval = TRUE, echo = FALSE, fig.align='center'}
knitr::include_graphics("img/type1-type2-error.svg")
```

---

# Alpha

Formally 

--

>- rejecting $H_0$ when it is true
  
--

>- the probability of making a <b style='color:#f4bfc5;'>Type I Error</b>

--

<br>
In Better Terms 

--

>- the chance of making the wrong decision when what was initially expected to happen actually occurs

--

>- Given by $\alpha$

>- Ranges from 0-1 like all other probabilities

--

<br>
<center>
Typically `\alpha = 0.05` but its really context dependent
</center>

---


# Example

<center>
For airplanes
</center>
<br>

--

.pull-left[
- if they fly people around, then when **analyzing failures**

>- you may want to lower the probability of making a wrong decision

>- use a **smaller** $\alpha$
]

--

.pull-right[
- if they're made of paper, then when **analyzing   failures**

>- you might be willing accept the higher risk of making the wrong decision

>- use a **higher** $\alpha$
]

---

# Beta

Formally 

--

>-  not rejecting the $H_0$ when $H_1$ is true

--
  
>-  the probability of making a <b style='color:#f4bfc5;'>Type II Error</b>

--

<br>
In Better Terms 

--

>- the chance of making the wrong decision when an something else actually occurs

--

>- Given by $\beta$

--

>- Ranges from 0-1 like all other probabilities

---

# Power

- $1-\beta$ is called **statistical power**

--


  - extremely important!
  
--

  - Formally - the probability of NOT making a Type II error
  
--

  - In Better Terms - the chance that you can separate if an outcome is a result of something occurring vs.  pure luck!

---
  
# Decision Making

```{r eval = TRUE, echo = FALSE}
decision_gen <- tibble(  

`Reality` = c(
  "",
  "",
  "",
  "`H_0` is true",
  "",
  "",
  "",
  "",
  "",
  "`H_0` is false",
  "",
  ""),

`Rejected Null` = c(
  "",
  "",
  "Type I Error",
  "`alpha`",
  "Chance of rejecting `H_0` when it is true /<br><span style='color:#f4eebf;'><b><i>Level of Significance</b></i></span>",
  "",
  "",
  "",
  "Correct Decision",
  "`1-beta`",
  "<span style='color:#f4eebf;'><b><i>Statistical Power!</b></i></span>",
  ""),

`Did Not Reject Null` = c(
  "",
  "",
  "Correct decision",
  "`1-alpha`", 
  "<span style='color:#f4eebf;'><b><i>Level of Confidence</b></i></span>",
  "",
  "",
  "",
  "Type II Error",
  "`beta`",
  "<span style='color:#f4eebf;'><b><i>Rate of a Type II Error</b></i></span> /<br>Chance of accepting `H_0` when it is false",
  "")
)
```

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE}
kable(decision_gen, 
      escape = FALSE,
      align = 'lcc') %>%
  kable_styling(full_width = FALSE) %>%
  column_spec(1, width = "10em") %>%
  column_spec(2, width = "10em") %>%
  column_spec(3, width = "10em") %>%
  row_spec(0, extra_css = "border-bottom: solid;
           border-bottom-width:1px;
           border-bottom-color: #666666;")
```

---

# Decision Making

 |  | 
--------|---------|---------
Null | $H_0 =$ | "Forecast says its NOT going to rain"
Alternative | $H_1 =$ | "Something else will happen"
 |  | 
<br style="line-height: 3px" />

--

```{r eval = TRUE, echo = FALSE}
example_gen <- tibble(
Reality = c("Forecast was right",
             "Forecast was wrong"),

`Did not reject the forecast` = c("Did not take an umbrella and you're dry",
             "Did not take an umbrella AND you're wet"),

`Rejected forecast` = c("Took an umbrella AND you're dry but may look silly or possibly fancy",
                    "Took an umbrella AND you're dry")
)
```

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE}
kable(example_gen, 
      escape = FALSE,
      format = "html",
      align = 'lll') %>%
  kable_styling(full_width = FALSE) %>%
  column_spec(1, width = "10em") %>%
  column_spec(2, width = "10em") %>%
  column_spec(3, width = "10em") %>%
  row_spec(0, extra_css = "border-bottom: solid;
           border-bottom-width:1px;
           border-bottom-color: #666666;") %>%
  row_spec(2, extra_css = "border-bottom: solid;
           border-bottom-width:1px;
           border-bottom-color: #666666;") %>%
  footnote(
    general = c(
      "<small><i>You could have also gotten wet from snow, a flood, etc. so again <b>the alternative hypothesis generally does not imply the opposite!</b></i></small>"
    ),
    general_title = "<small>Note: </small>",
    footnote_as_chunk = T ,
    escape = F
  )
```
<br style="line-height: 3px" />

---

# Estimation

- **(Statistical) Estimation** - a sample statistic is used to estimate the value of an unknown population parameter

--

  - **Point estimation** - use of sample data to calculate a single value
  
--

  - **Interval estimation** - use of sample data to calculate a possible range of values
  
--

<br>
<center>
<i>Selecting a sample mean</i>
</center>
<br>

```{r eval = TRUE, echo = FALSE}
sig_est <- tibble(
Classification = c("Process",
             "Outcomes"),

`Hypothesis Testing` = c("Determine the probability of getting that mean if the Null is true",
             "Gain information about the population mean"),

`Point/Interval Estimation` = c("Estimate the value of a population mean",
                    "Gain information about the population mean")
)
```

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE}
kable(sig_est, 
      escape = FALSE,
      align = 'lll', 
      format = "html") %>%
  kable_styling(full_width = FALSE) %>%
  column_spec(1, width = "10em") %>%
  column_spec(2, width = "10em") %>%
  column_spec(3, width = "10em") %>%
  row_spec(0, extra_css = "border-bottom: solid;
           border-bottom-width:1px;
           border-bottom-color: #666666;")
```

---

# Updating Estimation for Sample Means

--

- **Point estimation** - use of sample data to calculate a single **mean** value

--

  - Benefit - the sample mean will equal the population mean on average
  
--
  
  - Drawback - unable to figure out if a sample mean actually equals the population mean
  
--

- **Interval estimation** - use of sample data to calculate a possible range of **mean** values

---

# The Characteristic of Hypothesis Testing and Estimation

```{r eval = TRUE, echo = FALSE}
hyp_est <- tibble(
Question = c("Do we know the population mean?",
             "What is the process use dto determine?",
             "What is learned?",
             "What is our decision?"),

`Hypothesis Testing` = c("Yes its the Null hypothesis",
             "The chance of obtaining a sample mean", 
             "Whether the population mean is likely correct",
             "To retain or reject the null hypothesis"),

`Point/Interval Estimation` = c("No we're trying to estimate it",
                    "The value of a population mean",
                    "The range of values within which the population mean is probably contained",
                    "No actual decison")
)
```

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE}
kable(hyp_est, 
      escape = FALSE,
      align = 'lll') %>%
  kable_styling(full_width = FALSE) %>%
  column_spec(1, width = "10em") %>%
  column_spec(2, width = "10em") %>%
  column_spec(3, width = "10em") %>%
  row_spec(0, extra_css = "border-bottom: solid;
           border-bottom-width:1px;
           border-bottom-color: #666666;")
```

---

# Confidence

--

- **Confidence Interval** - an interval that contains an unknown parameter (e.g. $\mu$) with certain degree of confidence

--

- **Level of Confidence** - probability or likelihood that an interval estimate will contain an unknown population parameter

---

# Determining the Confidence Interval

1. Calculate the standard error of the mean $$\sigma_{\overline{Y}} =\dfrac{\sigma}{\sqrt{N}}$$

--

2. Decide on a level of confidence

```{r eval = TRUE, echo = FALSE}
conf <- tibble(
Probability = c("0.90",
                "0.95",
                "0.99"),

"`z`-score" = c("1.645",
                "1.96", 
                "2.576")
)
```

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE}
kable(conf, 
      escape = FALSE,
      align = 'cc') %>%
  kable_styling(full_width = FALSE) %>%
  row_spec(0, extra_css = "border-bottom: solid;
           border-bottom-width:1px;
           border-bottom-color: #666666;")
```

<br>
<br>
<center>
Again its typical to have a 95% level of confidence thereby making \[\alpha = 0.05\]
</center>

---

# Determining the Confidence Interval (continued)

<ol start=3>
<li> `CI = \overline{Y} \pm z\cdot\sigma_{\overline{Y}}`
</ol>

--

<ol start=4>
<li> Interpret the results
</ol>

---

# Example

IQ scores in the general healthy population are approximately normally distributed with $100 ± 15$. In a sample of 100 students a sample mean IQ of 103. Find the 90% confidence interval for this data.

--

Firstly we have $N = 100$, $\mu=100$, $\sigma = 15$, and $\overline{Y} = 103$.

--

1. $$\sigma_{\overline{Y}} = \dfrac{\sigma}{\sqrt{N}} =\dfrac{15}{\sqrt{100}} = 1.50$$

--

2. Want to find 90% confidence interval, so choose a 90% level of confidence.

$$z\cdot \sigma_{\overline{Y}} = 1.645\cdot 1.50 = 2.47$$
---

<ol start=3>
<li> So

$$ 90\%\, CI = 103\pm2.47 = (105.47, 100.53) $$
</ol>

--

<ol start=4>
<li> We are 90% confident that the overall mean IQ is between 100.53 and 105.47.
</ol>

---

## That's it. Take a break before our R session!
