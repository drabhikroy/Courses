---
title: "Sampling and Sampling Distributions"
linktitle: "Week 7: Sampling and Sampling Distributions"
menu:
  tasks:
    parent: Homeworks
    weight: 7
type: docs
weight: 2
editor_options: 
  chunk_output_type: console
---

```{r load_packages, message=FALSE, warning=FALSE, include=FALSE}
library(tidyverse)
library(knitr)
library(kableExtra)
library(fontawesome)
library(here)
library(patchwork)
```

<style>
span.boxed {
  border: 0px solid #FFFFFF;
  padding: 5px;
  color: #FFFFFF;
  background-color: #005b96;
  display: inline;
} 

table {
   margin-left: auto;
   margin-right: auto;
}

table thead th { border-bottom: 1px solid #ddd; 
}

th, td { padding: 5px; 
}

tr:nth-child(even) { background: #ffffff; 
}
</style>

### Homework
```{r icontibble, echo=FALSE, message=FALSE}
book <- tibble(
  
  chapter <- c("6"),
  
  exercises <- c("1, 2, 3, 4, 5, 6, 7, 8, 9"),
  
  problems <- c("Social Statistics for a Diverse Society"),
  
  pages <- c("206-210"),
  
  .name_repair = "minimal"
  
)
```

<center>
```{r, echo=FALSE}
book %>%
  kbl(col.names = c("Chapter", "Problems", "Source", "Pages"), 
      "html", 
      escape = FALSE,
      align = 'clll') %>%
  column_spec(1, 
              bold = TRUE)
```
</center>

Notes: 

- Please submit this at the beginning of class next week.
- Remember to follow the [homework guidelines](/tasks/#homeworks) for consideration.

<!--
to the Submission Portal on [ecampus](https://ecampus.wvu.edu/){target="_blank"} by 11:59 PM next Wednesday.<br>
-->


### Solutions

*Posted after class day and time next week.*

<!--
### Solutions

<details><summary>1</summary>
<p>

a. Although there are problems with the collection of data from all Americans, the census is assumed to be complete, so the mean age would be a <span class="boxed">parameter</span>.
    
b. A <span class="boxed">statistic</span> because it is estimated from a sample.
  
c. A <span class="boxed">parameter</span> because the school would have information on all its students.
  
d. A <span class="boxed">statistic</span> because it is estimated from a sample.
  
e. A <span class="boxed">parameter</span> because the school has information on all employees.

</p>
</details>

<details><summary>2</summary>
<p>

a. First, the population is not clearly defined. Are the population subscribers to the newspaper? Readers of the newspaper? Or some other set of people? Even given this uncertainty, the letters to the editor would only be a random sample of a population if, clearly, they came randomly from that population. But there is no reason to assume this to be the case. People with stronger opinions, who can write reasonably well, and who have the time to write are more likely to write the editor. Since these characteristics are not distributed randomly throughout the adult population, it is improbable that the letters are a random sample.

b. The mayor might consider forming a coalition to randomly sample landline and cell phone numbers of city residents.

</p>
</details>

<details><summary>3</summary>
<p>

a. Assuming that the population is defined as all persons shopping at that shopping mall that day of the week, she is selecting a systematic random sample. A more precise definition might limit it to all persons passing by the department store at the mall that day.

b. This is a stratified sample because voters were first grouped by county, and unless the counties have the same number of voters, it is a disproportionate stratified sample because the same number is chosen from each county. We can assume that it was a probability sample, but we are not told exactly how the 50 voters were chosen from the lists. However, assuming that the population is defined as all Americans, this sort of sampling technique would qualify as nonprobability sampling.

c. This is neither a simple random sample nor a systematic random sample. It might be thought of as a sample stratified on last name, but even then, choosing the first 20 names is not a random selection process.

d. This is not a probability sample. Instead, it is a purposive sample chosen to represent a cross section of the population in New York City.

</p>
</details>

<details><summary>4</summary>
<p>

a. There are 120 students where 57 are juniors who represent $57\div120 = 47.5$, or 47.5% of the class. This implies the probability of choosing a junior is <span class="boxed">$0.475$</span>.

b. The probability that the student will be a freshman is $7\div120 =$ <span class="boxed">$0.058$</span>.

c. The proportion of seniors in the class is $34/120 = 0.283$. The proportion of sophomores is $22\div120 = 0.183$. Then the number of students to be chosen at each class level is:
<div align="center">
<div style="width: 50%; margin:0 left;text-align: left;">
```{r, echo=FALSE, eval=TRUE}
level <- tibble(
  
  class = c("Freshman", 
            "Sophomore", 
            "Junior", 
            "Senior"),
  
  calculation = c("0.058(30)", 
                  "0.183(30)",
                  "0.475(30)",
                  "0.283(30)"),
  
  result = c("1.74", 
             "5.49", 
             "14.25", 
             "8.49")
  
) 

level %>%
  kable(align = 'lcc',
        booktabs = TRUE, 
        linesep = "",
        col.names = c("Class Level", "Calculation", "Result")) %>%
  kable_styling(full_width = FALSE) 
```
</div>
</div>
or about <span class="boxed">2 freshman</span>, <span class="boxed">5 sophomores</span>, <span class="boxed">14 juniors</span>, and <span class="boxed">8 seniors</span>.

d. For a disproportionate sample we choose the same number of students from each class level. For example, we could have <span class="boxed">5 freshman</span>, <span class="boxed">5 sophomores</span>, <span class="boxed">5 juniors</span>, and <span class="boxed">5 seniors</span>.

</p>
</details>

<details><summary>5</summary>
<p>
<div style="padding-left: 30px;">

The relationship between the standard error and the standard deviation is $\sigma_{\overline{Y}} =\frac{\sigma}{\sqrt{N}}$. Since $\sigma$ is divided by $\sqrt{N}$, $\sigma_{\overline{Y}} =\frac{\sigma}{\sqrt{N}}$ must always be smaller than $\sigma$ barring the trivial case where $N = 1$. Theoretically, the dispersion of the mean must be less than the dispersion of the raw scores. This implies that <span class="boxed">the standard error of the mean is less than the standard deviation</span>.
</div>
</p>
</details>
      
<details><summary>6</summary>
<p>
      
<div style="padding-left: 30px;">

First note that the standard error of the mean is proportional to $\frac{1}{\sqrt{N}}$.
      </div>
        
  a. The standard error of the mean is<br><br> 
$\sigma_{\overline{Y}} =\frac{\sigma}{\sqrt{100}}=\frac{\sigma}{10}$ for a sample size of 100<br><br>
          $\sigma_{\overline{Y}} =\frac{\sigma}{\sqrt{1600}}=\frac{\sigma}{40}$ for a sample size of 16000<br><br>
            We compare the two by $\frac{40}{10} =4$. So $\sigma_{\overline{Y}} =\frac{\sigma}{\sqrt{N}}$ <span class="boxed">is smaller by a factor of 4</span> when the sample size increases from 100 to 1600.

  b. The standard error of the mean is<br><br> 
              $\sigma_{\overline{Y}} =\frac{\sigma}{\sqrt{300}}\approx\frac{\sigma}{17.32}$ for a sample size of 300<br><br>
              $\sigma_{\overline{Y}} =\frac{\sigma}{\sqrt{150}}\approx\frac{\sigma}{12.25}$ for a sample size of 150<br><br>
              We compare the two by $\frac{17.32}{12.25} \approx 1.41$. So $\sigma_{\overline{Y}} =\frac{\sigma}{\sqrt{N}}$ <span class="boxed">is greater by a factor of 1.41</span> when the sample size decreases from 300 to 150.
            
  c. For simplicity, assume an initial sample size of 100. We then have
            $\sigma_{\overline{Y}} =\frac{\sigma}{\sqrt{100}}=\frac{\sigma}{10}$ for a sample size of 10 0<br><br>
              $\sigma_{\overline{Y}} =\frac{\sigma}{\sqrt{4\cdot100}}=\frac{\sigma}{20}$ for a sample size of 4000<br><br>
We compare the two by $\frac{20}{10} = 2$. So $\sigma_{\overline{Y}} =\frac{\sigma}{\sqrt{N}}$ <span class="boxed">decreases by a factor of 2</span>.
            
</p>
</details>
              
              
<details><summary>7</summary>
<p>
              
  a. Facebook ® polls are most definitely not probability samples. While many reasons exists, the two noted below are likely the most important: 
              - the *population* from which data are gathered is limited to the *friends* on one’s Facebook ® profile--and such is certainly not a representative sample from the larger population.
            - due to Facebook ® algorithms, we can’t be sure that every Facebook ® friend would have the same opportunity to see, and thus participate, in the poll.
            
  b. The population is our Facebook ® friends who come across the poll.
            
</p>
</details>
              
<details><summary>8</summary>
  
  <div style="padding-left: 30px;">

First we convert these to a vector and take the sum
  ```{r, echo=TRUE, eval=TRUE}
  military <- c(229634, 64564, 376034, 89826, 26384, 41441, 177336, 68440, 8579)
  
  total_mil <- sum(military)
  ```
  </div>
  a. The mean number of active military personnel per region in 2009 was 
      ```{r, echo=TRUE, eval=TRUE}
      mu_mil = mean(military)
      
      mu_mil
      ```
      or about <span class="boxed">120249</span>. The standard deviation is
      ```{r, echo=TRUE, eval=TRUE}
      sd_pop=function(x){sd(x)*sqrt((length(x)-1)/length(x))}
      
      sigma_mil = sd_pop(military)
      
      sigma_mil
      ```
      or about <span class="boxed">112966</span>.
  b. We can use the `sample` command to get our 10 sample means of size 3. We can use the `replcate` and `rnorm` commands in R to do this 
      ```{r, echo=TRUE, eval=TRUE}
      # replicate(size #, rnorm(#of sample means, mu, sigma))
      
      samples <- replicate(3,rnorm(10, mu_mil,sigma_mil))
      
      samples
      ```
  c. The mean of these 10 sets of means is 
      ```{r, echo=TRUE, eval=TRUE}
      mean(samples)
      ```
      or about <span class="boxed">105428</span>. We notice that the population mean and the mean of the sampling distribution are somewhat close, a feature that we should come to expect given the fact that $\mu_Y = \mu_{\overline{Y}}$.
  d. The standard deviation of these 10 sets of means is
      ```{r, echo=TRUE, eval=TRUE}
      sd(samples)
      ```
      or about <span class="boxed">122991</span>.
  e. The population distribution is positively skewed and not close to normal. Since a very small sample size is used in this problem, the histogram for the samples of size 3 does not look normal. The distributions appear unimodal. The fact that the sample distribution of the means tends toward normality because of the Central Limit Theorem would become even more apparent if we took samples of size 5 or 6. To show this, look at the plots below
      ```{r, echo=FALSE, eval=TRUE, warning = FALSE}
      # Convert into tibbles
      sample_means <- samples %>% 
        as_tibble() %>%
        rowwise() %>% 
        mutate(sample_mus = mean(c(V1, V2, V2))) %>%
        select(sample_mus)
  
      military_tib <- military %>%
        as_tibble() %>%
        rename(pop = value)
  
      # Plot the distributions
      p1 <- ggplot(military_tib, aes(x = pop)) + 
        geom_histogram(aes(y =..density..,
                       fill =..count..),
                   binwidth = 100000,
                   color="#333333",
                   show.legend = FALSE) +
        scale_fill_gradient(low = "#ff6347",
                        high = "#4682b4",
                        breaks = seq(0, 400000, 
                                     by = 100000)) + 
        scale_x_continuous(labels = function(x)                format(x, scientific = FALSE)) +
        scale_y_continuous(labels = function(x)                format(x*1000000, scientific = FALSE)) +
        stat_function(fun=dnorm,
                  color="#66b2b2",
                  size = 1.5,
                  args=list(mean=mean(military), 
                            sd=sd_pop(military))) +
        theme_minimal() +
        xlab("Population") +
        ylab("Count") + 
        theme(plot.margin = margin(t = 0, r = 1, b = 0, l = 0, "cm"))
  
      p2 <- ggplot(military_tib, aes(x = pop)) + 
              geom_histogram(aes(y =..density..,
                       fill =..count..),
                   binwidth = 100000,
                   color="#333333",
                   show.legend = FALSE) +
            scale_fill_gradient(low = "#ff6347",
                        high = "#4682b4",
                        breaks = seq(0, 400000, 
                                     by = 100000)) + 
          scale_x_continuous(labels = function(x) format(x, scientific = FALSE)) +
    scale_y_continuous(labels = function(x) format(x*1000000, scientific = FALSE)) +
    stat_function(fun=dnorm,
                  color="#66b2b2",
                  size = 1.5,
                  args=list(mean=mean(military), 
                            sd=sd_pop(military))) +
    theme_minimal() +
    xlab("Population") +
    ylab("Count") + 
    theme(plot.margin = margin(t = 0, r = 1, b = 0, l = 0, "cm"))
  
  
  p2 <- ggplot(sample_means, aes(x = sample_mus)) + 
    geom_histogram(aes(y =..density..,
                       fill =..count..),
                   binwidth = 50000,
                   color="#333333",
                   show.legend = FALSE) +
    scale_fill_gradient(low = "#ff6347",
                        high = "#4682b4",
                        breaks = seq(0, 250000, 
                                     by = 50000)) + 
    scale_x_continuous(labels = function(x) format(x, scientific = FALSE)) +
    scale_y_continuous(labels = function(x) format(x*1000000, scientific = FALSE)) +
    stat_function(fun=dnorm,
                  color="#66b2b2",
                  size = 1.5,
                  args=list(mean=mean(sample_means$sample_mus), 
                            sd=sd(sample_means$sample_mus))) +
    theme_minimal() +
    xlab("Sample") +
    ylab("Count") + 
    theme(plot.margin = margin(t = 0, r = 0, b = 0, l = 1, "cm"))
  
  # This uses the patchwork package
  p1 + p2
  
  ```
</p>
</details>
    
<details><summary>9</summary>
<p>
    
  a. This is not a reliable sample. The students eating lunch on Tuesday are not necessarily representative of all students at the school, and you have no way of calculating the probability of inclusion of any student. Many students might, for example, rarely eat lunch at the student union and, therefore, have no chance of being represented in your sample. The fact that you selected all the students eating lunch on Tuesday makes your selection appear to be a census of a population, but that isn’t true either unless all the students ate at the student union on Tuesday.
  
  b. This is not a reliable sample. The majority of people in attendance at the rally would probably be in support of open borders. Students against such might not have any chance of selection.
  
  c. Answers will vary, but it seems the best route would be to obtain a list of all registered students from your university’s registrar. And then employ a known sampling strategy (simple random sampling, stratified sampling, etc.) to create your sample of 10% of the student body. From there, you would reach out to each person you’ve selected via e-mail, telephone, mail, and so on and ask them to complete your survey.  
  
</p>
</details>
-->
